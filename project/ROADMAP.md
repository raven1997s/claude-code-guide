# 产品需求优先级矩阵与依赖图

> **更新时间**: 2026-01-01
> **产品负责人**: PM
> **版本**: v2.1 (Sprint UI 完成，Phase 1 已定义)

---

## 🎉 Sprint UI 完成总结

**状态**: ✅ Sprint UI (Phase 0) 已完成验收，批准发布

| 需求ID | 需求标题 | 工作量 | 状态 |
|--------|----------|--------|------|
| REQ-UI.1 | Design Tokens | 0.5 MD | ✅ 完成 |
| REQ-UI.2 | 组件视觉重构 | 1.5 MD | ✅ 完成 |
| REQ-UI.3 | 主题切换 | 1 MD | ✅ 完成 |
| REQ-UI.4 | 移动端响应式 | 1 MD | ✅ 完成 |

**总工时**: 4 MD | **周期**: 2-3 周 (实际 2 小时)
**验收报告**: [Sprint-UI-Acceptance-Report.md](./Sprint-UI-Acceptance-Report.md)

---

## 📊 优先级矩阵 (更新后)

### MoSCoW 分析 (v2.1)

| 需求ID | 需求标题 | MoSCoW | 价值 | 紧急度 | 工作量 | ROI |
|--------|----------|--------|------|--------|--------|-----|
| **REQ-P2.1** | 全局体验优化 | **Must** | 🔴 高 | 🔴 高 | 6.5 MD | ⭐⭐⭐⭐⭐ |
| ├─ REQ-P2.1.1 | 基础组件优化 | **Must** | 🔴 高 | 🔴 高 | 1.5 MD | ⭐⭐⭐⭐⭐ |
| ├─ REQ-P2.1.2 | 动画过渡系统 | **Must** | 🔴 高 | 🔴 高 | 1 MD | ⭐⭐⭐⭐⭐ |
| ├─ REQ-P2.1.3 | 各页面视觉优化 | Should | 🔴 高 | 🟡 中 | 2 MD | ⭐⭐⭐⭐ |
| ├─ REQ-P2.1.4 | 可访问性优化 | Should | 🟡 中 | 🟡 中 | 0.75 MD | ⭐⭐⭐ |
| └─ REQ-P2.1.5 | 性能优化 | **Must** | 🔴 高 | 🟡 中 | 0.5 MD | ⭐⭐⭐⭐ |
| **REQ-1.1** | 搜索历史记录 | **Must** | 🔴 高 | 🟢 低 | 0.5 MD | ⭐⭐⭐⭐ |
| **REQ-2.1** | 关卡提示系统 | **Must** | 🔴 高 | 🟢 低 | 1.5 MD | ⭐⭐⭐⭐ |
| **REQ-2.2** | 成就系统 | Should | 🟡 中 | 🟢 低 | 1 MD | ⭐⭐⭐ |
| REQ-1.2 | 热门搜索标签 | Should | 🟡 中 | 🟢 低 | 0.5 MD | ⭐⭐⭐ |
| REQ-1.3 | 正则搜索 | Could | 🟢 低 | 🟢 低 | 1 MD | ⭐⭐ |
| REQ-3.2 | 键盘快捷键 | Could | 🟢 低 | 🟢 低 | 0.5 MD | ⭐⭐ |

**图例**:
- 🔴 高 | 🟡 中 | 🟢 低
- ROI (投资回报率): ⭐ 数量越多,优先级越高

---

## 🔗 需求依赖关系图 (更新后)

```mermaid
graph TD
    <!-- 核心基础 -->
    CORE[现有功能: 25关卡 + 搜索系统 + VSCode教程]

    === Sprint UI Phase 0 (已完成) ===
    DT[REQ-UI.1 Design Tokens ✅]
    CR[REQ-UI.2 组件视觉重构 ✅]
    TS[REQ-UI.3 主题切换 ✅]
    MR[REQ-UI.4 移动端响应式 ✅]

    === Phase 1 全局体验优化 (当前优先级) ===
    CP[REQ-P2.1.1 基础组件优化]
    AS[REQ-P2.1.2 动画过渡系统]
    PV[REQ-P2.1.3 各页面视觉优化]
    AX[REQ-P2.1.4 可访问性优化]
    PF[REQ-P2.1.5 性能优化]

    === Phase 2 搜索与游戏化 (已定义) ===
    SH[REQ-1.1 搜索历史]
    HS[REQ-2.1 关卡提示系统]
    ASYS[REQ-2.2 成就系统]

    === Backlog (待定义) ===
    ST[REQ-1.2 热门标签]
    SR[REQ-1.3 正则搜索]
    PVZ[REQ-2.3 进度可视化]
    KH[REQ-3.2 键盘快捷键]

    <!-- 依赖关系 -->
    CORE --> DT

    DT --> CR
    DT --> TS
    DT --> MR

    DT --> CP
    CP --> AS
    CP --> PV
    AS --> AX
    PV --> PF

    CORE --> SH
    CORE --> HS
    CP --> ASYS

    SH --> ST
    SH --> SR
    HS --> ASYS
    ASYS --> PVZ

    CORE --> KH

    <!-- 样式定义 -->
    classDef completed fill:#10b981,stroke:#059669,color:#fff,stroke-width:3px
    classDef current fill:#6366f1,stroke:#4f46e5,color:#fff,stroke-width:3px
    classDef next fill:#f59e0b,stroke:#d97706,color:#fff,stroke-dasharray: 5 5
    classDef backlog fill:#94a3b8,stroke:#64748b,color:#fff
    classDef core fill:#1e293b,stroke:#0f172a,color:#fff

    class DT,CR,TS,MR completed
    class CP,AS,PV,AX,PF current
    class SH,HS,ASYS next
    class ST,SR,PVZ,KH backlog
    class CORE core
```

### 依赖说明

| 需求 | 前置依赖 | 原因 |
|------|----------|------|
| **REQ-UI.2** | **REQ-UI.1** | 需要 Design Tokens 才能重构组件 |
| **REQ-UI.3** | **REQ-UI.1** | 需要 Design Tokens 才能实现主题切换 |
| **REQ-UI.4** | **REQ-UI.1** | 需要 Design Tokens 才能做响应式 |
| REQ-1.2 | REQ-1.1 | 需要历史数据生成热门统计 |
| REQ-2.2 | REQ-2.1 | 提示系统降低卡关率,成就系统激励完成 |

---

## 🎯 推荐实施顺序 (更新后)

### 🔥 Phase 0: Sprint UI (最高优先级) - 立即开始
**目标**: 建立统一的设计基础，避免后期重构成本

| 顺序 | 需求ID | 需求标题 | 工作量 | 理由 |
|------|--------|----------|--------|------|
| 1️⃣ | **REQ-UI.1** | **Design Tokens** | **0.5 MD** | **基础中的基础,必须最先完成** |
| 2️⃣ | **REQ-UI.2** | **组件视觉重构** | **1.5 MD** | **基于 Design Tokens 重构所有组件** |
| 3️⃣ | **REQ-UI.3** | **主题切换** | **1 MD** | **基于 Design Tokens 实现主题切换** |
| 4️⃣ | **REQ-UI.4** | **移动端响应式** | **1 MD** | **基于 Design Tokens 优化移动端** |

**预计总工时**: 4 MD
**预计周期**: 2-3 周
**状态**: 🟢 **立即开始**

---

### ⏸️ Phase 1: 搜索优化 (暂停)
**目标**: 提升用户查找命令的效率
**状态**: 🟡 等待 Sprint UI 完成

| 顺序 | 需求ID | 需求标题 | 工作量 |
|------|--------|----------|--------|
| 5️⃣ | REQ-1.1 | 搜索历史记录 | 0.5 MD |
| 6️⃣ | REQ-1.2 | 热门搜索标签 | 0.5 MD |
| 7️⃣ | REQ-1.3 | 正则搜索 | 1 MD |

**预计总工时**: 2 MD

---

### ⏸️ Phase 2: 游戏化增强 (暂停)
**目标**: 提升用户学习动力和留存率
**状态**: 🟡 等待 Sprint UI 完成

| 顺序 | 需求ID | 需求标题 | 工作量 |
|------|--------|----------|--------|
| 8️⃣ | REQ-2.1 | 关卡提示系统 | 1.5 MD |
| 9️⃣ | REQ-2.2 | 成就系统 | 1 MD |
| 🔟 | REQ-2.3 | 学习进度可视化 | 1 MD |

**预计总工时**: 3.5 MD

---

### ⏸️ Phase 3: UX 改进 (暂停)
**目标**: 完善体验,覆盖长尾需求
**状态**: 🟡 等待 Sprint UI 完成

| 顺序 | 需求ID | 需求标题 | 工作量 |
|------|--------|----------|--------|
| 1️⃣1️⃣ | REQ-3.2 | 键盘快捷键 | 0.5 MD |

**预计总工时**: 0.5 MD

---

## 📈 价值 vs 复杂度矩阵

```
高价值 │
      │  ● REQ-1.1 (搜索历史)
      │  ● REQ-2.1 (提示系统)
      │
      │          ● REQ-1.2 (热门标签)
      │          ● REQ-2.2 (成就系统)
      │
      │                      ● REQ-1.3 (正则搜索)
      │                      ● REQ-3.2 (快捷键)
      │
      └──────────────────────────────────────► 低复杂度
       低复杂度                    高复杂度
```

**解读**:
- **左上角 (高价值低复杂度)**: 优先实施 (REQ-1.1, REQ-2.1)
- **右上角 (高价值高复杂度)**: 谨慎评估 (REQ-1.3, REQ-3.2)
- **左下角 (低价值低复杂度)**: 填充实施 (REQ-1.2)

---

## 🚀 风险评估

| 需求ID | 风险等级 | 风险描述 | 缓解措施 |
|--------|----------|----------|----------|
| REQ-1.1 | 🟢 低 | LocalStorage 容量限制 | 实施容量监控 |
| REQ-2.1 | 🟡 中 | 提示干扰学习流程 | 添加用户关闭选项 |
| REQ-2.2 | 🟡 中 | 动画性能问题 | 使用 CSS 动画,避免 JS 动画 |
| REQ-1.3 | 🟡 中 | 正则表达式安全性 | 输入验证 + 沙箱执行 |
| REQ-1.2 | 🟢 低 | 数据统计偏差 | 定期清理异常数据 |

---

## 📋 执行检查清单

### 开发前
- [ ] 所有需求 PRD 已完成
- [ ] 技术可行性已评估
- [ ] 依赖关系已确认
- [ ] 测试用例已准备

### 开发中
- [ ] 按依赖顺序实施
- [ ] 每日进度同步
- [ ] 代码审查通过
- [ ] 单元测试覆盖率 ≥ 80%

### 发布后
- [ ] 功能监控正常
- [ ] 用户反馈收集
- [ ] 数据指标分析
- [ ] 迭代计划更新

---

## 📞 决策点

### 需要确认的问题

1. **REQ-1.1 vs REQ-2.1 优先级**:
   - 问题: 搜索历史和提示系统都是 Must Have,先做哪个?
   - 建议: **先做 REQ-1.1** (工作量小,无依赖,快速见效)

2. **REQ-2.2 复杂度**:
   - 问题: 成就系统动画可能超出预算
   - 建议: **Phase 1 先做基础版本**,动画在 Phase 2 优化

3. **REQ-1.3 必要性**:
   - 问题: 正则搜索用户需求是否强烈?
   - 建议: **暂缓实施**,先收集用户反馈

---

**最后更新**: 2026-01-01
**下一步**: @项目经理 请确认排期,@前端开发 请评估技术可行性